# 가볍고 표준: alpine 권장 (원하면 latest 유지 가능)
FROM nginx:1.25-alpine

# conf.d가 '파일'로 잘못 남아있어도 제거하고 디렉터리로 보장 + ACME 웹루트 생성
RUN if [ -f /etc/nginx/conf.d ]; then rm -f /etc/nginx/conf.d; fi \
    && mkdir -p /etc/nginx/conf.d /var/www/certbot

# 메인 설정 (반드시 conf.d/*.conf를 include 하도록 작성)
COPY nginx/nginx.conf /etc/nginx/nginx.conf

CMD ["nginx", "-g", "daemon off;"]
