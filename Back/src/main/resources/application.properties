spring.profiles.active=local

server.servlet.session.timeout=1800

#jackson?? KST? ??
spring.jackson.time-zone=Asia/Seoul
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.force=true
spring.security.user.name=${SPRING_SECURITY_USER_NAME}
spring.security.user.password=${SPRING_SECURITY_USER_PASSWORD}
spring.servlet.multipart.max-file-size=200MB
spring.servlet.multipart.max-request-size=200MB

# Tomcat large payload tuning
server.tomcat.max-http-form-post-size=200MB
server.tomcat.max-swallow-size=-1

# ========================================
# HikariCP Connection Pool (부하 테스트 대응)
# ========================================
# 근거:
# - 50팀 동시 접속 시나리오 (카운트다운 종료 직후)
# - 각 요청당 1개 DB 연결 필요
# 설정:
# - maximum-pool-size=50: 최대 50개 DB 연결
# - minimum-idle=10: 평상시 10개 연결 유지
# - connection-timeout=30000: 연결 대기 최대 30초
spring.datasource.hikari.maximum-pool-size=50
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ========================================
# Tomcat Thread Pool (동시 요청 처리)
# ========================================
# 근거:
# - 50팀 + 여유분 고려
# - Spring Boot 기본값: 200 threads
# 설정:
# - max=200: 최대 200개 스레드
# - min-spare=10: 최소 10개 스레드 유지
# - accept-count=100: 대기열 크기
# - max-connections=10000: 최대 연결 수
server.tomcat.threads.max=200
server.tomcat.threads.min-spare=10
server.tomcat.accept-count=100
server.tomcat.max-connections=10000

# ========================================
# Auto-Ban Configuration (산업 표준 기반)
# ========================================
auto-ban.enabled=true

# ========================================
# Flag Brute Force Protection
# ========================================
# 근거:
# - CTF 업계: 초당 10회 제한
# - REST API 표준: 분당 100회
# 설정:
# - 의심: 1분에 30회 오답 → 관리자 알림 (의심스러운 IP 목록)
# - 차단: 1분에 50회 오답 → 30분 자동 차단
# 효과: 자동화 스크립트 차단, 정상 사용자 보호, 조기 경보
auto-ban.flag-brute.suspicious-threshold=30
auto-ban.flag-brute.max-wrong-attempts=50
auto-ban.flag-brute.time-window-minutes=1
auto-ban.flag-brute.ban-duration-minutes=30

# ========================================
# API Rate Limiting (DDoS 방어)
# ========================================
# 근거:
# - Stripe: 초당 100회
# - GitHub: 시간당 5000회 (분당 83회)
# - REST API 표준: 분당 100회
# 설정:
# - 의심: 초당 80회 이상 → 관리자 알림
# - 경고: 초당 100회 이상 → 로그 기록
# - 차단: 초당 200회 이상 → 15분 자동 차단
# 효과: 극단적 DDoS만 차단, 조기 경보
auto-ban.rate-limit.suspicious-threshold=80
auto-ban.rate-limit.max-requests-per-second=100
auto-ban.rate-limit.ban-duration-minutes=15

# ========================================
# Login Brute Force Protection
# ========================================
# 근거:
# - Fail2Ban: 10분에 3-5회 → 10분 차단
# - Cloudflare: 1분에 5회 → 1시간 차단
# - AWS WAF: 5분에 10-100회 (로그인)
# 설정:
# - 의심: 5분에 30회 실패 → 관리자 알림
# - 차단: 5분에 50회 실패 → 1시간 자동 차단
# 효과: 사용자 편의 고려, 자동화 스크립트만 차단, 조기 경보
auto-ban.login-brute.suspicious-threshold=30
auto-ban.login-brute.max-failed-attempts=50
auto-ban.login-brute.time-window-minutes=5
auto-ban.login-brute.ban-duration-minutes=60

# ========================================
# Suspicious Payload Detection (SQL Injection/XSS)
# ========================================
# 근거: 명백한 공격 시도, 정상 사용자는 이런 패턴 없음
# 설정: 3회 감지 → 2시간 차단
# 효과: 엄격한 보안
auto-ban.suspicious-payload.max-attempts=3
auto-ban.suspicious-payload.ban-duration-minutes=120

# ========================================
# Directory Scanning Detection (404 스캐닝)
# ========================================
# 근거: 자동화된 취약점 스캐닝 도구 차단
# 설정: 5분에 50회 404 → 30분 차단
# 효과: 스캐닝 도구만 차단
auto-ban.not-found.max-attempts=50
auto-ban.not-found.time-window-minutes=5
auto-ban.not-found.ban-duration-minutes=30
